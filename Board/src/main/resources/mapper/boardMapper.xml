<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 다른 mapper와 중복되지 않도록 네임스페이스 기재 -->
<mapper namespace="boardDAO">
	<!-- 게시판 목록 -->
	<select id="list" resultType="boardDTO">
	<![CDATA[
		select b.num, b.title, u.name, b.date, b.count, b.id 
		from b_board as b
		inner join b_users as u
		where b.id = u.id and del_chk = 'N'
		order by num desc
	]]>
	</select>
	
	<!-- 게시물 전체 수 가져오기 -->
	<select id="boardCount" resultType="int">
		select count(*) from b_board;
	</select>
	
	<!-- 페이지 적용 -->
	<select id="pageList" resultType="hashmap" parameterType="hashmap">
	<![CDATA[
        select b.num, b.title, u.name, date_format(b.date, '%Y-%m-%d') as date, b.count, b.id 
        from b_board as b
        inner join b_users as u
        where b.id = u.id and del_chk = 'N'
        order by num desc
        limit #{pageStart}, #{perPageNum}
    ]]>
	</select>
	
	<!-- 총 게시글 수 -->
	<select id="countBoardList" resultType="Integer">
    <![CDATA[
        select count(*)
        from b_board
        where del_chk = 'N'
    ]]>
	</select>

	<!-- 해당 게시글 보기 -->
	<select id="select" parameterType="int" resultType="boardDTO">
		select * from b_board
		where num = #{num}
	</select>
	
	<!-- 삽입 -->
	<insert id="insert" parameterType="boardDTO">
		insert into b_board (title, contents, id) values(#{title},#{contents},#{id}) 
	</insert>
	
	<!-- 수정 -->
	<update id="update" parameterType="boardDTO">
		update b_board set title = #{title},
		contents = #{contents}
		where num = #{num}
	</update>
	
	<!-- 조회수 증가 -->
	<update id="updateCount" parameterType="int">
		update b_board set
		count = count+1
		where num = #{num}
	</update>
	
	<!-- 삭제 
	<delete id="delete" parameterType="boardDTO">
		delete from b_board
		where num = #{num}
	</delete> -->
	
	<!-- 삭제 : 상태값 -->
	<delete id="delete" parameterType="boardDTO">
	<![CDATA[
		update b_board set del_chk = 'Y'
		where num = #{num}
	]]> 
	</delete>
</mapper>